<!DOCTYPE html>
<html lang="en">
    <body>
        <p id="text"></p>
        <script>
            const xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () 
            {
                if (this.readyState == 4 && this.status == 200) 
                {
                    displayData(this.responseXML);
                }
            };

            xhttp.open("GET", "..//customers.xml", true);
            xhttp.send();

            function stringToNode(html) 
            {
                const template = document.createElement(`template`);
                html = html.trim();
                template.innerHTML = html;
                return template.content.firstChild;
            }

            function displayData(customerData) 
            {
                const listElement = document.getElementById(`text`);
                const infoNodes = customerData.getElementsByTagName(`customer`);

                for (let index = 0; index < infoNodes.length; index++) 
                {
                    const infoNode = infoNodes[index];
                    console.log(infoNode.getElementsByTagName(`order`))
                    const listItem = stringToNode(`<li type="1">
                    <h1>${
                    infoNode.getElementsByTagName(`name`)[0].attributes[0].nodeValue
                    } </h1>
                    <h2>${
                    infoNode.getElementsByTagName(`name`)[0].childNodes[0].nodeValue
                    }</h2>
                    <h3>
                    <p> Address: ${infoNode.getElementsByTagName(`address`)[0].childNodes[0].nodeValue} </p>
                    <p> Phone Number: +1 ${infoNode.getElementsByTagName(`phone`)[0].childNodes[0].nodeValue} </p>
                    <p>${`Email: ${
                        infoNode.getElementsByTagName(`email`)[0] ? infoNode.getElementsByTagName(`email`)[0].childNodes[0].nodeValue : ""
                    }`}</p>
                    </h3>
                    
                    <ul id="${infoNode.getAttribute('custID')}"> 
                        
                        <h4> Order Items </h4> </ul> 
                    </li>`);

                    listElement.appendChild(listItem);
                }
                displayOrderData(customerData)
            }
      
            function displayOrderData(orderData) 
            {
                const orderNodes = orderData.getElementsByTagName(`order`);
                for (let index = 0; index < orderNodes.length; index++) 
                {
                    const orderNode = orderNodes[index];
                    console.log(orderNode.getElementsByTagName(`items`)[0].children[0].getElementsByTagName('itemPrice')[0].childNodes[0].nodeValue)
                    const orderElement = document.getElementById(`${ orderNode.getAttribute('orderBy')}`);
                    const orderItems = stringToNode(`
                    <ol>
                    <p> Order Date: ${orderNode.getElementsByTagName(`orderDate`)[0].childNodes[0].nodeValue} </p>
                    <p> Item Price: ${orderNode.getElementsByTagName(`items`)[0].children[0].getElementsByTagName('itemPrice')[0].childNodes[0].nodeValue} </p>
                    <p> Item Qty: ${orderNode.getElementsByTagName(`items`)[0].children[0].getElementsByTagName('itemQty')[0].childNodes[0].nodeValue} </p>
                    </ol>`);
                    orderElement.appendChild(orderItems);
                }
            }
        </script>
    </body>
</html>